<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Calculator: Calculator.Presenter.DatabaseManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Calculator
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('class_calculator_1_1_presenter_1_1_database_manager.html','','class_calculator_1_1_presenter_1_1_database_manager-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Calculator.Presenter.DatabaseManager Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class responsible for interacting with Database. Allows to add operations, exchange rate dates, exchange rate codes, exchange rates. It also can read latest exchange data and return best exchange rate in given period.  
 <a href="#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Calculator.Presenter.DatabaseManager:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_calculator_1_1_presenter_1_1_database_manager.png" usemap="#Calculator_2EPresenter_2EDatabaseManager_map" alt=""/>
  <map id="Calculator_2EPresenter_2EDatabaseManager_map" name="Calculator_2EPresenter_2EDatabaseManager_map">
<area href="interface_calculator_1_1_presenter_1_1_i_database_manager.html" title="Interface used for test mocking - for more info check &lt;see cref=&quot;DatabaseManager&quot;/." alt="Calculator.Presenter.IDatabaseManager" shape="rect" coords="0,0,240,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2bfc591048ab28ed9f69ec92473703b1" id="r_a2bfc591048ab28ed9f69ec92473703b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2bfc591048ab28ed9f69ec92473703b1">DatabaseManager</a> (<a class="el" href="class_calculator_1_1_presenter_1_1_s_q_lite_db_context.html">SQLiteDbContext</a> context)</td></tr>
<tr class="memitem:a44efebba739d11de24a2caf8cb296644" id="r_a44efebba739d11de24a2caf8cb296644"><td class="memItemLeft" align="right" valign="top">async Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44efebba739d11de24a2caf8cb296644">AddOperation</a> (string operationText, double result, string operationName)</td></tr>
<tr class="memdesc:a44efebba739d11de24a2caf8cb296644"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds an operation to the DB.  <br /></td></tr>
<tr class="memitem:ae74a92d20e8fb3710c6ff04c8b292da5" id="r_ae74a92d20e8fb3710c6ff04c8b292da5"><td class="memItemLeft" align="right" valign="top">async Task&lt; <a class="el" href="class_calculator_1_1_model_1_1_currency_rate_date.html">CurrencyRateDate</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae74a92d20e8fb3710c6ff04c8b292da5">AddExchangeRateDate</a> (DateTime time)</td></tr>
<tr class="memdesc:ae74a92d20e8fb3710c6ff04c8b292da5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a new exchange rate date to CurrencyRateDates db and returns the Id of newly created tuple. If the date already exists returns its Id instead.  <br /></td></tr>
<tr class="memitem:af4c5d09d789469387ed3fc8a1eecd8da" id="r_af4c5d09d789469387ed3fc8a1eecd8da"><td class="memItemLeft" align="right" valign="top">async Task&lt; <a class="el" href="class_calculator_1_1_model_1_1_currency_rate_code.html">CurrencyRateCode</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4c5d09d789469387ed3fc8a1eecd8da">AddExchangeRateCode</a> (string code)</td></tr>
<tr class="memitem:a7f0ecf69df6f8e345b149308d21482c9" id="r_a7f0ecf69df6f8e345b149308d21482c9"><td class="memItemLeft" align="right" valign="top">async Task&lt; List&lt; <a class="el" href="class_calculator_1_1_data_1_1_currency_rate.html">CurrencyRate</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f0ecf69df6f8e345b149308d21482c9">AddExchangeRates</a> (Dictionary&lt; string, double &gt; rateDict, DateTime date)</td></tr>
<tr class="memdesc:a7f0ecf69df6f8e345b149308d21482c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each item in dictionary it searches the db for <a class="el" href="class_calculator_1_1_model_1_1_currency_rate_code.html" title="Represents a 3-character currency code.">CurrencyRateCode</a> with matching code (if it finds none it creates new one), then searches for exchange rate with todays date (if finds none it adds one). If it finds a rate with todays date it gets updates with new rate Adds a number of currency rates with given dateId to a db and returns them as List. If cares with this date exist, they are updated instead.  <br /></td></tr>
<tr class="memitem:a3385b566593951191544315f8002f69b" id="r_a3385b566593951191544315f8002f69b"><td class="memItemLeft" align="right" valign="top">async Task&lt; List&lt; <a class="el" href="class_calculator_1_1_data_1_1_currency_rate.html">CurrencyRate</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3385b566593951191544315f8002f69b">GetExchange</a> ()</td></tr>
<tr class="memdesc:a3385b566593951191544315f8002f69b"><td class="mdescLeft">&#160;</td><td class="mdescRight">It asks database for most recent rates and return them as a list.  <br /></td></tr>
<tr class="memitem:aa81a5148b7f585ba15e4ae3651639a55" id="r_aa81a5148b7f585ba15e4ae3651639a55"><td class="memItemLeft" align="right" valign="top">async Task&lt;(string, DateTime)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa81a5148b7f585ba15e4ae3651639a55">GetBestRateFromPeriod</a> (string currencyFrom, string currencyTo, DateTime startPeriod, DateTime endPeriod)</td></tr>
<tr class="memdesc:aa81a5148b7f585ba15e4ae3651639a55"><td class="mdescLeft">&#160;</td><td class="mdescRight">It reads currency codes from db correspoding to given strings. Then it fetches the rates data between given start Date and end Date. Then it calcualte the exchange rate between two currency codes for each day and finds the highest.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class responsible for interacting with Database. Allows to add operations, exchange rate dates, exchange rate codes, exchange rates. It also can read latest exchange data and return best exchange rate in given period. </p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2bfc591048ab28ed9f69ec92473703b1" name="a2bfc591048ab28ed9f69ec92473703b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bfc591048ab28ed9f69ec92473703b1">&#9670;&#160;</a></span>DatabaseManager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Calculator.Presenter.DatabaseManager.DatabaseManager </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_calculator_1_1_presenter_1_1_s_q_lite_db_context.html">SQLiteDbContext</a></td>          <td class="paramname"><span class="paramname"><em>context</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="af4c5d09d789469387ed3fc8a1eecd8da" name="af4c5d09d789469387ed3fc8a1eecd8da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4c5d09d789469387ed3fc8a1eecd8da">&#9670;&#160;</a></span>AddExchangeRateCode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt; <a class="el" href="class_calculator_1_1_model_1_1_currency_rate_code.html">CurrencyRateCode</a> &gt; Calculator.Presenter.DatabaseManager.AddExchangeRateCode </td>
          <td>(</td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>code</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implements <a class="el" href="interface_calculator_1_1_presenter_1_1_i_database_manager.html#a12624215000de0d501db7059f6198887">Calculator.Presenter.IDatabaseManager</a>.</p>

</div>
</div>
<a id="ae74a92d20e8fb3710c6ff04c8b292da5" name="ae74a92d20e8fb3710c6ff04c8b292da5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae74a92d20e8fb3710c6ff04c8b292da5">&#9670;&#160;</a></span>AddExchangeRateDate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt; <a class="el" href="class_calculator_1_1_model_1_1_currency_rate_date.html">CurrencyRateDate</a> &gt; Calculator.Presenter.DatabaseManager.AddExchangeRateDate </td>
          <td>(</td>
          <td class="paramtype">DateTime</td>          <td class="paramname"><span class="paramname"><em>time</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a new exchange rate date to CurrencyRateDates db and returns the Id of newly created tuple. If the date already exists returns its Id instead. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time to be checked agains.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A task contains the &lt;see cref="CurrencyRateDate"/.</dd></dl>

<p>Implements <a class="el" href="interface_calculator_1_1_presenter_1_1_i_database_manager.html#a513d0a1147004c755d27e8253f926d5f">Calculator.Presenter.IDatabaseManager</a>.</p>

</div>
</div>
<a id="a7f0ecf69df6f8e345b149308d21482c9" name="a7f0ecf69df6f8e345b149308d21482c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f0ecf69df6f8e345b149308d21482c9">&#9670;&#160;</a></span>AddExchangeRates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt; List&lt; <a class="el" href="class_calculator_1_1_data_1_1_currency_rate.html">CurrencyRate</a> &gt; &gt; Calculator.Presenter.DatabaseManager.AddExchangeRates </td>
          <td>(</td>
          <td class="paramtype">Dictionary&lt; string, double &gt;</td>          <td class="paramname"><span class="paramname"><em>rateDict</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DateTime</td>          <td class="paramname"><span class="paramname"><em>date</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each item in dictionary it searches the db for <a class="el" href="class_calculator_1_1_model_1_1_currency_rate_code.html" title="Represents a 3-character currency code.">CurrencyRateCode</a> with matching code (if it finds none it creates new one), then searches for exchange rate with todays date (if finds none it adds one). If it finds a rate with todays date it gets updates with new rate Adds a number of currency rates with given dateId to a db and returns them as List. If cares with this date exist, they are updated instead. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rateDict</td><td>Dictionary where key correspond to currency codes, and values to rates.</td></tr>
    <tr><td class="paramname">dateId</td><td>Day at wchich the dictionary data was optained</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A task contins the list of &lt;see cref="CurrencyRateDate"/.</dd></dl>

<p>Implements <a class="el" href="interface_calculator_1_1_presenter_1_1_i_database_manager.html#aea8815a567881d869f36adcde75307a4">Calculator.Presenter.IDatabaseManager</a>.</p>

</div>
</div>
<a id="a44efebba739d11de24a2caf8cb296644" name="a44efebba739d11de24a2caf8cb296644"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44efebba739d11de24a2caf8cb296644">&#9670;&#160;</a></span>AddOperation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task Calculator.Presenter.DatabaseManager.AddOperation </td>
          <td>(</td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>operationText</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>result</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>operationName</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds an operation to the DB. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operationText</td><td>Body of the operation.</td></tr>
    <tr><td class="paramname">result</td><td><a class="el" href="class_calculator_1_1_data_1_1_operation.html" title="Saves operations including: text of operation, it&#39;s result, time at wchich it happened and koreign ke...">Operation</a> result.</td></tr>
    <tr><td class="paramname">operationName</td><td>Name of the operation type.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>No object or value is returned by this method when it completes.</dd></dl>

<p>Implements <a class="el" href="interface_calculator_1_1_presenter_1_1_i_database_manager.html#a515d0054f2ea67e1cb34c005f8ab5c0b">Calculator.Presenter.IDatabaseManager</a>.</p>

</div>
</div>
<a id="aa81a5148b7f585ba15e4ae3651639a55" name="aa81a5148b7f585ba15e4ae3651639a55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa81a5148b7f585ba15e4ae3651639a55">&#9670;&#160;</a></span>GetBestRateFromPeriod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt;(string, DateTime)&gt; Calculator.Presenter.DatabaseManager.GetBestRateFromPeriod </td>
          <td>(</td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>currencyFrom</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>currencyTo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DateTime</td>          <td class="paramname"><span class="paramname"><em>startPeriod</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DateTime</td>          <td class="paramname"><span class="paramname"><em>endPeriod</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It reads currency codes from db correspoding to given strings. Then it fetches the rates data between given start Date and end Date. Then it calcualte the exchange rate between two currency codes for each day and finds the highest. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">currencyFrom</td><td>Currency code of currency to exchange from.</td></tr>
    <tr><td class="paramname">currencyTo</td><td>Currency code of currency to exchange to.</td></tr>
    <tr><td class="paramname">startPeriod</td><td>Start day of searched period.</td></tr>
    <tr><td class="paramname">endPeriod</td><td>End day of searched period.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A task contins the tuple containg best exchange rate as string and day of this rate.</dd></dl>

<p>Implements <a class="el" href="interface_calculator_1_1_presenter_1_1_i_database_manager.html#a8ed55578e17024a5afc3b4e670bc3f86">Calculator.Presenter.IDatabaseManager</a>.</p>

</div>
</div>
<a id="a3385b566593951191544315f8002f69b" name="a3385b566593951191544315f8002f69b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3385b566593951191544315f8002f69b">&#9670;&#160;</a></span>GetExchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt; List&lt; <a class="el" href="class_calculator_1_1_data_1_1_currency_rate.html">CurrencyRate</a> &gt; &gt; Calculator.Presenter.DatabaseManager.GetExchange </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It asks database for most recent rates and return them as a list. </p>
<dl class="section return"><dt>Returns</dt><dd>&gt;A task contins the list of &lt;see cref="CurrencyRateDate"/.</dd></dl>

<p>Implements <a class="el" href="interface_calculator_1_1_presenter_1_1_i_database_manager.html#aba2116f790bd08fff52450857f9861f8">Calculator.Presenter.IDatabaseManager</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Calculator/Presenter/<a class="el" href="_database_manager_8cs.html">DatabaseManager.cs</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespace_calculator.html">Calculator</a></li><li class="navelem"><a href="namespace_calculator_1_1_presenter.html">Presenter</a></li><li class="navelem"><a href="class_calculator_1_1_presenter_1_1_database_manager.html">DatabaseManager</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
